# k3d-specific JupyterHub configuration
# Use ClusterIP service type and route through Traefik Ingress
# This avoids port conflicts with Traefik's LoadBalancer on port 80

proxy:
  service:
    type: ClusterIP

hub:
  baseUrl: "/"
  config:
    JupyterHub:
      # Disable XSRF for local dev behind proxy
      # This is safe for local dev but should NOT be used in production
      tornado_settings:
        xsrf_cookies: false

singleuser:
  storage:
    type: none
    # Runtime-mount local LER-U folder into notebook pods (k3d dev)
    # NOTE: k3d nodes must be created with a matching volume mount to /mnt/leru
    # Use map-form (not list) to match the chart default type and avoid Helm merge warnings.
    extraVolumes:
      leru:
        hostPath:
          path: /mnt/leru
          type: Directory
    extraVolumeMounts:
      leru:
        mountPath: /opt/leru
        readOnly: false
  networkPolicy:
    enabled: false
  extraEnv:
    PYTHONPATH: "/opt/leru"

# Disable the pre-puller explicitly to avoid "hook-image-awaiter" timeouts
prePuller:
  hook:
    enabled: false
  continuous:
    enabled: false

